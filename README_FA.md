# CheX-XAI ๐ฉบ
**ููุด ูุตููุน ูุงุจู ุชูุถุญ ุจุฑุง ุชุดุฎุต ููุณู ุณูู (X-Ray)**

---

## ๐ ูุนุฑู ูพุฑูฺู
ูพุฑูฺู **CheX-XAI** ฺฉ ฺุงุฑฺูุจ ูุงฺููุงุฑ ุจุฑ ูพุงู PyTorch ุจุฑุง ุขููุฒุด ู ุงุฑุฒุงุจ ูุฏูโูุง ุงุฏฺฏุฑ ุนูู ุจุฑ ุฑู ุฏุชุงุณุช **CheXpert** ุงุณุช.
ุงู ุณุณุชู ุงุฒ ุณุงุฎุชุงุฑ ูพฺฉุฑุจูุฏโุดููุฏู ุจุฑุง ุขููุฒุดุ ุงุฑุฒุงุจ ุชูุถุญโูพุฐุฑ (Explainable AI)ุ ุฏุงุฏูโูุง ุชุฑฺฉุจ (ุฎุงู + ูุงุณฺฉโุฏุงุฑ)ุ ู ุซุจุช ฺฉุงูู ูุงฺฏโูุง ุจุฑุง ุจุงุฒุชููุฏ ูุชุงุฌ ูพุดุชุจุงู ูโฺฉูุฏ.

ุฏุฑ ุงู ูุฎุฒูุ **ุณู ฺฏุงู ุงูู** ุงุฒ ูุฑุขูุฏ ูพุงู (Baseline) ูพุงุฏูโุณุงุฒ ุดุฏู ุงุณุช:
- ุจุงุฑฺฏุฐุงุฑ ู ูพุดโูพุฑุฏุงุฒุด ุฏุงุฏูโูุง
- ุขููุฒุด ูุฏู ุจุง ุฏูุช ุชุฑฺฉุจ (AMP)
- ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ุจุง AUROC ู ุขุณุชุงููโูุง F1 ูุฎุตูุต ูุฑ ฺฉูุงุณ
- ุซุจุช ุฎูุฏฺฉุงุฑ ูุชุฑฺฉโูุง ู ุชูุธูุงุช ุจุฑุง ุชฺฉุฑุงุฑูพุฐุฑ ฺฉุงูู

---

## โ๏ธ ุณุงุฎุชุงุฑ ูพุฑูฺู
```
chex-xai/
โ
โโโ configs/
โ   โโโ train.yaml        # ูพฺฉุฑุจูุฏ ุขููุฒุด
โ   โโโ paths.yaml        # ูุณุฑูุง ุฏุงุฏู ู ุฎุฑูุฌโูุง
โ
โโโ src/chex_xai/         # ูุงฺูู ุงุตู ฺฉุฏูุง
โ   โโโ data/             # ฺฉูุงุณโูุง ู ุชูุงุจุน ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏูโูุง
โ   โโโ models/           # ูุนูุงุฑ ูุฏูโูุง (DenseNet121 ู ...)
โ   โโโ engine/           # ุญูููโูุง ุขููุฒุด ู ุงุฑุฒุงุจ
โ   โโโ metrics/          # ูุญุงุณุจู AUROC ู F1
โ   โโโ utils/            # ุชูุงุจุน ฺฉูฺฉ (seedุ checkpoint ู ...)
โ
โโโ scripts/              # ุงุณฺฉุฑูพุชโูุง ุงุฌุฑุง ูุณุชูู
โ   โโโ train.py          # ุขููุฒุด ูุฏู
โ   โโโ eval.py           # ุงุฑุฒุงุจ ูุฏู
โ   โโโ compute_thresholds.py  # ูุญุงุณุจู ุขุณุชุงูู ุจููู F1
โ   โโโ dump_class_support.py  # ูุญุงุณุจู ุขูุงุฑ ฺฉูุงุณโูุง (ูุซุจุช/ููู)
โ
โโโ outputs/
    โโโ chexpert_baseline_v1/
        โโโ best.pt / last.pt             # ูุฒูโูุง ุฐุฎุฑูโุดุฏู
        โโโ metrics_eval.json             # ูุชุงุฌ AUROC ู F1
        โโโ thresholds.json               # ุขุณุชุงูู ุจููู ูุฑ ฺฉูุงุณ
        โโโ class_support.json            # ุขูุงุฑ ฺฉูุงุณโูุง
        โโโ config_resolved.yaml          # ูพฺฉุฑุจูุฏ ููุง ุขููุฒุด
        โโโ env.txt                       # ุงุทูุงุนุงุช ูุญุท ุงุฌุฑุง
```

---

##  ุดุฑูุน ุณุฑุน

###  1๏ธโฃ ุงุฌุงุฏ ูุญุท ูุฌุงุฒ
```bash
python -m venv .venv
source .venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

###  2๏ธโฃ  ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง
ุณุงุฎุชุงุฑ ูพุดููุงุฏ ูพูุดู ุฏุงุฏูโูุง:
```
data/
โโโ splits/
โ   โโโ train.csv
โ   โโโ dev.csv
โ   โโโ test.csv
โโโ CheXpert-v1.0/
โ   โโโ train/
โ   โโโ valid/
โ   โโโ test/
โโโ data_masked/   # (ุงุฎุชุงุฑ) ูุณุฎูโูุง ูุงุณฺฉโุดุฏู ุชุตุงูุฑ
```

ุฏุฑ ุตูุฑุช ูุงุฒ ูุณุฑูุง ุฑุง ุฏุฑ `configs/paths.yaml` ุชูุธู ฺฉูุฏ.

---

###  3๏ธโฃ  ุขููุฒุด ูุฏู
ุขููุฒุด ูุฏู ูพุงู (DenseNet121 ุจุง ุงูุฏุงุฒู ุชุตูุฑ 320ร320):
```bash
python scripts/train.py
```

ุฎุฑูุฌ ุขููุฒุด ุฏุฑ ูุณุฑ ุฒุฑ ุฐุฎุฑู ูโุดูุฏ:
```
outputs/chexpert_baseline_v1/
```

---

###  4๏ธโฃ  ุงุฑุฒุงุจ ููุง
ุงุฌุฑุง ุงุฑุฒุงุจ ฺฉุงูู ููุฑุงู ุจุง AUROC ู F1 ุจุฑุง ูุฑ ฺฉูุงุณ:
```bash
python scripts/compute_thresholds.py --ckpt outputs/chexpert_baseline_v1/best.pt --exp outputs/chexpert_baseline_v1
python scripts/dump_class_support.py
python scripts/eval.py --ckpt outputs/chexpert_baseline_v1/best.pt --amp \
  --thresholds outputs/chexpert_baseline_v1/thresholds.json --exp outputs/chexpert_baseline_v1
```

ูุชุงุฌ ููุง ุฏุฑ ูุงู ุฒุฑ ุฐุฎุฑู ุฎูุงููุฏ ุดุฏ:
```
outputs/chexpert_baseline_v1/metrics_eval.json
```

---

## ๐ ูุชุงุฌ ูพุงู (Baseline)
| ุดุงุฎุต | Dev | Test |
|:------|:------|:------|
| AUROC (ูุงฺฉุฑู) | **0.712** | **0.720** |
| AUROC (ูฺฉุฑู) | 0.722 | 0.683 |
| F1 (ูุงฺฉุฑูุ ุขุณุชุงููโุฏุงุฑ) | 0.357 | 0.388 |
| F1 (ูฺฉุฑูุ ุขุณุชุงููโุฏุงุฑ) | 0.540 | 0.534 |

> ูุฏู: **DenseNet121** (ูพุดโุขููุฒุดโุฏุฏู ุฑู ImageNetุ ุงูุฏุงุฒู 320ร320)
> ุณุฎุชโุงูุฒุงุฑ: **NVIDIA A100 40GB** ุจุง CUDA 12.8
> ุฏุชุงุณุช: **CheXpert** (ฑณ ุจุฑฺุณุจ ุจูุงุฑ ููุณู ุณูู)

---

## ๐ ูุงุจูุช ุจุงุฒุชููุฏ
ุฏุฑ ูุฑ ุงุฌุฑุง ุขุฒูุงุดุ ูุงูโูุง ุฒุฑ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุฌุงุฏ ูโุดููุฏ:
- `config_resolved.yaml` โ ุชูุธูุงุช ุขููุฒุด
- `env.txt` โ ูุณุฎูโูุง ูุญุท ู CUDA
- `metrics_eval.json` โ ูุชุงุฌ ููุง ูุฏู
- `thresholds.json` โ ุขุณุชุงููโูุง ุจููู F1 ุจุฑุง ูุฑ ฺฉูุงุณ

ุชูุงู seedูุง ุจุฑุงุจุฑ `42` ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏูโุงูุฏ ุชุง ูุชุงุฌ ูุงุจู ุชฺฉุฑุงุฑ ุจุงุดูุฏ.

---

## ๐ ูุฌูุฒ ุงุณุชูุงุฏู
ุงู ูพุฑูฺู ุตุฑูุงู ุจุฑุง ุงูุฏุงู ูพฺููุด ู ุขููุฒุด ููุชุดุฑ ุดุฏู ุงุณุช.
ยฉ 2025 โ ุชูุณุนู ุฏุงุฏูโุดุฏู ุชูุณุท **ุนู ุนุจุงุณ** ู ููฺฉุงุฑุงู.
